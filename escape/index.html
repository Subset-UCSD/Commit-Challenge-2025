<!doctype html>
<html>
<head>
    <meta charset="utf-8" />

    <title>SUBSëT 2025</title>
    <meta name="description" content="⊆ ⊆ ⊆ ⊆ ⊆ ⊆ ⊆ ⊆ ⊆ ⊆ ⊆ ⊆ ⊆ ⊆ ⊆ ⊆">
    <meta name="theme-color" content="#BE3144">
    <meta name="twitter:card" content="summary_large_image">

    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style type="text/css">
        :root {color-scheme: dark;
        accent-color: #BE3144;}
    body {
        color: #E17564;
        background-color: #09122C;
        margin: 0;
        padding: 0;
        font-family: Georgia , Garamond , 'Times New Roman', Times, serif;
    }
    #div {
        width: 600px;
        margin: 1in auto;
        padding: 2em;
        background-color: #872341;
        border-radius: 0.5em;
        resize: both;
    }
    nav a {
        color: #E17564;
        text-decoration: none;
    }
    @media (max-width: 700px) {
        #div {
            margin: 1in 10px;
            width: auto;
        }
    }
    #location {
      color: orange;
      font-style: italic;
    }
    #choices {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    #choices button {
      background-color: #BE3144;
      color: white;
      font: inherit;
      border: none;
      cursor: pointer;
      width: 100%;
      padding: 10px;
      box-sizing: border-box;
    }
    </style>
</head>

<body>
<div id="div">
    <nav style="margin-top: -60px; margin-bottom: 40px; color:#872341 ">
        escape &subseteq; commit challenge
        &bull;
        <a href="../">back</a>
    </nav>

    <p id="location"></p>
    <p id="description"></p>
    <div id="choices"></div>
    <p id="inventory"></p>

    <script src="./GAME.js"></script>


    <script>
      let current = BEGINNING

      function renderInventory () {
        if (inventory.length === 0) {
          document.getElementById('inventory').innerHTML=''
          return
        }
        const freq = {}
        for (const item of inventory) {
          freq[item] ??=0
          freq[item] ++
        }
        document.getElementById('inventory').innerHTML = 'you have: '+Object.entries(freq).map(([item, count]) => item + (count>1?` (${count})` :'')).join(', ')
      }

      function render () {
        const { location, description, choices } = current()
        document.getElementById('location').innerHTML = location
        document.getElementById('description').innerHTML = description
        document.getElementById('choices').innerHTML = Object.keys(choices).map((choice, i) => `<button onclick="select(${i})">${choice}</button>`).join('')
        renderInventory()
      }

      function select (index) {
        const { location, description, choices } = current()
        const next = Object.values(choices)[index]
        const result = next()
        if (typeof result === 'string') {
          // something happened
          document.getElementById('description').innerHTML = result
          document.getElementById('choices').innerHTML = '<button onclick="render()">ok</button>'
          renderInventory()
        } else {
          current = next
          render()
        }
      }

      render()
    </script>
</div>

</div>
</body>
</html>
